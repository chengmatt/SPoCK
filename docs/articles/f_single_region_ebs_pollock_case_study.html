<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Setting up a Single Region Model (Eastern Bering Sea Pollock) • SPoRC</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Setting up a Single Region Model (Eastern Bering Sea Pollock)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SPoRC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Setting up a Single Region Model (Eastern Bering Sea Pollock)</h1>
            
      

      <div class="d-none name"><code>f_single_region_ebs_pollock_case_study.Rmd</code></div>
    </div>

    
    
<p>To further demonstrate additional funcionality of <code>SPoRC</code>,
we will use the 2024 eastern Bering Sea walleye pollock assessment as an
example. In particular, this vignette attempts to mimic the 2024
assessment. However, given the complexity and intricacies of the pollock
assessment, a direct match in estimates is not currently possible due to
a variety of factors, including:</p>
<ol style="list-style-type: decimal">
<li>The pollock assessment fits to the bottom trawl survey with a
covariance matrix, which is currently not possible in
<code>SPoRC</code>,</li>
<li>The bottom trawl survey follows a random walk process on logistic
selectivity parameters, but also allows for age-1 deviations on the
logistic functional form. This functionality is not incorporated in
<code>SPoRC</code>,</li>
<li>Different weight-at-age matrices are utilized to fit to biomass
indices, compute spawning biomass, and compute expected catches, which
is not currently allowed.</li>
</ol>
<p>Despite these differences, <code>SPoRC</code> can generally
approximate the dynamics of the 2024 assessment relatively closely.
First, let us load in any necessary packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load in packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://chengmatt.github.io/SPoRC">SPoRC</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaskr/RTMB" class="external-link">RTMB</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sgl_rg_ebswp_data"</span><span class="op">)</span> <span class="co"># load in data</span></span></code></pre></div>
<div class="section level3">
<h3 id="setup-model-dimensions">Setup Model Dimensions<a class="anchor" aria-label="anchor" href="#setup-model-dimensions"></a>
</h3>
<p>To initially set the model up, an input list containing a data list,
parameter list, and a mapping list needs to be constructed. This is
aided with the function <code>Setup_Mod_Dim</code>, where users specify
a vector of years, ages, and lengths. Additionally, users need to
specify the number of regions modelled (n_regions), number of sexes
modeled (n_sexes), number of fishery fleets (n_fish_fleets), and number
of survey fleets (n_srv_fleets)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Setup_Mod_Dim.html">Setup_Mod_Dim</a></span><span class="op">(</span></span>
<span>    years <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">years</span>,</span>
<span>    <span class="co"># vector of years</span></span>
<span>    ages <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">ages</span>,</span>
<span>    <span class="co"># vector of ages</span></span>
<span>    lens <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    <span class="co"># number of lengths</span></span>
<span>    n_regions <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="co"># number of regions</span></span>
<span>    n_sexes <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="co"># number of sexes</span></span>
<span>    n_fish_fleets <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="co"># number of fishery fleets</span></span>
<span>    n_srv_fleets <span class="op">=</span> <span class="fl">3</span> <span class="co"># number of survey fleets</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="setup-recruitment-dynamics">Setup Recruitment Dynamics<a class="anchor" aria-label="anchor" href="#setup-recruitment-dynamics"></a>
</h3>
<p>Following the initialization of <code>input_list</code>, we can pass
the created object into the next function (<code>Setup_Mod_Rec</code>)
to parameterize recruitment dynamics. In the case of Bering Sea Pollock,
recruitment is parameterized as such:</p>
<ol style="list-style-type: decimal">
<li>Beverton-Holt Recruitment, where steepness is fixed at the 2024
assessment estiamted value,</li>
<li>Recruitment deviations are estimated in a penalized likelihood
framework,</li>
<li>Recruitment deviations are estimated for all years,</li>
<li>Initial age deviations have a <code>ln_sigmaR = 2</code>, while
later deviations (after year 1) have a <code>ln_sigmaR = 1</code>. This
is done to mimic the current assessment, where a different mean
parameter is estimated for the early age deviations and later
recruitment deviations,</li>
<li>Initial age deviations are estimated for all ages, including the
plus group,</li>
<li>Initial age structure is derived by assuming a geometric series
(<code>init_age_strc = 1</code>; the alternative is iterating age
structure to some equilibrium <code>init_age_strc = 0</code>), and</li>
<li>Individuals are assumed to spawn during March
(<code>t_spawn = 0.25</code>)</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span>  <span class="va">inv_steepness</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">qlogis</a></span><span class="op">(</span><span class="op">(</span><span class="va">s</span> <span class="op">-</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Setup_Mod_Rec.html">Setup_Mod_Rec</a></span><span class="op">(</span></span>
<span>    input_list <span class="op">=</span> <span class="va">input_list</span>,</span>
<span></span>
<span>    <span class="co"># Model options</span></span>
<span>    do_rec_bias_ramp <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    <span class="co"># do bias ramp (0 == don't do bias ramp, 1 == do bias ramp)</span></span>
<span>    sigmaR_switch <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="co"># when to switch from early to late sigmaR (switch in first year)</span></span>
<span>    ln_sigmaR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co"># Starting values for early and late sigmaR</span></span>
<span>    rec_model <span class="op">=</span> <span class="st">"bh_rec"</span>,</span>
<span>    <span class="co"># recruitment model</span></span>
<span>    steepness_h <span class="op">=</span> <span class="fu">inv_steepness</span><span class="op">(</span><span class="fl">0.623013</span><span class="op">)</span>,</span>
<span>    h_spec <span class="op">=</span> <span class="st">"fix"</span>,</span>
<span>    <span class="co"># fixing steepness</span></span>
<span>    sigmaR_spec <span class="op">=</span> <span class="st">"fix"</span>,</span>
<span>    <span class="co"># fix early sigmaR and late sigmaR</span></span>
<span>    sexratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co"># recruitment sex ratio</span></span>
<span>    init_age_strc <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    ln_global_R0 <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    t_spawn <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>    equil_init_age_strc <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="co"># starting value for r0</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setup-biological-dynamics">Setup Biological Dynamics<a class="anchor" aria-label="anchor" href="#setup-biological-dynamics"></a>
</h2>
<p>Passing on the <code>input_list</code> that was updated in the
previous helper function, we can then parameterize the biological
dynamics of the model. The <code>Setup_Mod_Biologicals</code> requires
data inputs for weight-at-age (<code>WAA</code>) and maturity-at-age
(<code>MatAA</code>), both of which are dimensioned by
<code>n_regions</code>, <code>n_years</code>, <code>n_ages</code>,
<code>n_sexes</code>. In the case of Bering Sea pollock, natural
mortality is age-specific and fixed. Thus, a natural mortality array is
constructed and passed into the function, which is also dimensioned by
<code>n_regions</code>, <code>n_years</code>, <code>n_ages</code>,
<code>n_sexes</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span>  <span class="co"># Setup a fixed natural mortality array for use</span></span>
<span>  <span class="va">fix_natmort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_regions</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">ages</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">fix_natmort</span><span class="op">[</span>,,<span class="fl">1</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.9</span> <span class="co"># age 1 M</span></span>
<span>  <span class="va">fix_natmort</span><span class="op">[</span>,,<span class="fl">2</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.45</span> <span class="co"># age 2 M</span></span>
<span>  <span class="va">fix_natmort</span><span class="op">[</span>,,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="co"># age 3+ M</span></span>
<span>  </span>
<span>  <span class="va">input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Setup_Mod_Biologicals.html">Setup_Mod_Biologicals</a></span><span class="op">(</span></span>
<span>    input_list <span class="op">=</span> <span class="va">input_list</span>,</span>
<span></span>
<span>    <span class="co"># Data inputs</span></span>
<span>    WAA <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">WAA</span>,</span>
<span>    MatAA <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">MatAA</span>,</span>
<span></span>
<span>    <span class="co"># Model options</span></span>
<span>    <span class="co"># mean and sd for M prior</span></span>
<span>    fit_lengths <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    <span class="co"># don't fit length compositions</span></span>
<span>    M_spec <span class="op">=</span> <span class="st">"fix"</span>,</span>
<span>    <span class="co"># fixing natural mortality</span></span>
<span>    Fixed_natmort <span class="op">=</span> <span class="va">fix_natmort</span></span>
<span>  <span class="op">)</span></span>
<span>  </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setup-movement-and-tagging">Setup Movement and Tagging<a class="anchor" aria-label="anchor" href="#setup-movement-and-tagging"></a>
</h2>
<p>Given that this vignette demonstrates a single-region model, no
movement dynamics are specified. However, users will still need to
define how movement dynamics are parameterized. In this case, the
following code chunk specifies that movement is not estimated
(<code>use_fixed_movement = 1</code>), movement is an identity matrix
(<code>Fixed_Movement = NA</code>), and recruits do not move
(<code>do_recruits_move = 0</code>). Specification of tagging dynamics
will follow a similar fashion since this is a single-region model. All
that is necessary is updating the <code>input_list</code> and setting
the <code>UseTagging</code> argument to a value of 0.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># setup movement</span></span>
<span>  <span class="va">input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Setup_Mod_Movement.html">Setup_Mod_Movement</a></span><span class="op">(</span></span>
<span>    input_list <span class="op">=</span> <span class="va">input_list</span>,</span>
<span>    use_fixed_movement <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    Fixed_Movement <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    do_recruits_move <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># setup tagging</span></span>
<span>  <span class="va">input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Setup_Mod_Tagging.html">Setup_Mod_Tagging</a></span><span class="op">(</span></span>
<span>    input_list <span class="op">=</span> <span class="va">input_list</span>, </span>
<span>    UseTagging <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setup-catch-and-fishing-mortality">Setup Catch and Fishing Mortality<a class="anchor" aria-label="anchor" href="#setup-catch-and-fishing-mortality"></a>
</h2>
<p>Following the parameterization of biological dynamics, fishery
dynamics can then be specified and set up using the
<code>Setup_Mod_Catch_and_F</code> function. Again, the input_list that
gets updated from previous helper functions. Users will need to supply
the function with an array of observed catches <code>ObsCatch</code>,
which are dimensioned as <code>n_regions</code>, <code>n_years</code>,
and <code>n_fish_fleets</code>. Similarly, users will also need to
specify the catch type of these observations with the
<code>Catch_Type</code> argument. This argument expects a matrix
dimensioned by <code>n_years</code> and <code>n_fish_fleets</code>, and
is really only applicable in a spatial model (values of 0 indicate that
catch is aggregated across regions in some periods and fleets, while
values of 1 indicate catch is specific to each region in all periods and
fleets). Thus, in a single region model, values of <code>1</code> should
always be supplied. The function also expects the <code>UseCatch</code>
argument to be specified, which is dimensioned as
<code>n_regions</code>, <code>n_years</code>, and
<code>n_fish_fleets</code>. Essentially, users will need to fill out
whether catch is fit to for those particular partitions. Most use cases
of this argument are scenarios in which catch is observed to be a value
of 0, where the helper function automatically turns off the estimation
of fishing mortality deviations for those partitions. Additional model
options specified for this case study include whether fishing mortality
penalties are utilized to help estimate deviations
<code>Use_F_pen = 1</code>, and the <code>ln_sigmaC</code> values to fix
at.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Setup_Mod_Catch_and_F.html">Setup_Mod_Catch_and_F</a></span><span class="op">(</span></span>
<span>    input_list <span class="op">=</span> <span class="va">input_list</span>,</span>
<span></span>
<span>    <span class="co"># Data inputs</span></span>
<span>    ObsCatch <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">ObsCatch</span>,</span>
<span>    Catch_Type <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">Catch_Type</span>,</span>
<span>    UseCatch <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">UseCatch</span>,</span>
<span></span>
<span>    <span class="co"># Model options</span></span>
<span>    Use_F_pen <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="co"># whether to use f penalty, == 0 don't use, == 1 use</span></span>
<span>    sigmaC_spec <span class="op">=</span> <span class="st">"fix"</span>,</span>
<span>    <span class="co"># fixing catch standard deviation</span></span>
<span>    ln_sigmaC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="co"># starting / fixed value for catch standard deviation</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setup-fishery-indices-and-compositions">Setup Fishery Indices and Compositions<a class="anchor" aria-label="anchor" href="#setup-fishery-indices-and-compositions"></a>
</h2>
<p>To set up fishery indices and composition data, we will supply arrays
of fishery indices and their associated standard errors
(<code>ObsFishIdx</code> and <code>ObsFishIdx_SE</code>), which are
dimensioned by by <code>n_regions</code>, <code>n_years</code>,
<code>n_fish_fleets</code>. Additionally, we will supply both fishery
age composition data and length composition data. Both
<code>ObsFishAgeComps</code> and <code>ObsFishLenComps</code> are
dimensioned by <code>n_regions</code>, <code>n_years</code>,
<code>n_bins (n_ages | n_lens)</code>, <code>n_sexes</code>,
<code>n_fish_fleets</code>. Because the Bering Sea pollock model does
not fit to length composition data, <code>ObsFishLenComps</code> is
specified at <code>NA</code> and <code>UseFishLenComps</code> is
specified with 0s. Additionally, we specify that the fishery index is
biomass-based, multinomial likelihoods are utilized for age composition
data, and fishery age compositions are aggregatted across regions and
sexes (because this is a single-region single-sex model).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Setup_Mod_FishIdx_and_Comps.html">Setup_Mod_FishIdx_and_Comps</a></span><span class="op">(</span></span>
<span>    input_list <span class="op">=</span> <span class="va">input_list</span>,</span>
<span>    <span class="co"># data inputs</span></span>
<span>    ObsFishIdx <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">ObsFishIdx</span>,</span>
<span>    ObsFishIdx_SE <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">ObsFishIdx_SE</span>,</span>
<span>    UseFishIdx <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">UseFishIdx</span>,</span>
<span>    ObsFishAgeComps <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">ObsFishAgeComps</span>,</span>
<span>    UseFishAgeComps <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">UseFishAgeComps</span>,</span>
<span>    ISS_FishAgeComps <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">ISS_FishAgeComps</span>,</span>
<span>    ObsFishLenComps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">NA_real_</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">lens</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    UseFishLenComps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># Model options</span></span>
<span>    fish_idx_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"biom"</span><span class="op">)</span>,</span>
<span>    <span class="co"># indices for fishery</span></span>
<span>    FishAgeComps_LikeType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Multinomial"</span><span class="op">)</span>,</span>
<span>    <span class="co"># age comp likelihoods for fishery fleet</span></span>
<span>    FishLenComps_LikeType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span><span class="op">)</span>,</span>
<span>    <span class="co"># length comp likelihoods for fishery</span></span>
<span>    FishAgeComps_Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"agg_Year_1-terminal_Fleet_1"</span><span class="op">)</span>,</span>
<span>    <span class="co"># age comp structure for fishery</span></span>
<span>    FishLenComps_Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none_Year_1-terminal_Fleet_1"</span><span class="op">)</span>,</span>
<span>    <span class="co"># length comp structure for fishery</span></span>
<span>    FishAge_comp_agg_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="co"># ADMB aggregation quirks, ideally get rid of this</span></span>
<span>    FishLen_comp_agg_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="co"># ADMB aggregation quirks, ideally get rid of this</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setup-survey-indices-and-compositions">Setup Survey Indices and Compositions<a class="anchor" aria-label="anchor" href="#setup-survey-indices-and-compositions"></a>
</h2>
<p>Setting up survey indices and compositions follows a similar fashion.
Here, will supply arrays of survey indices and their associated standard
errors (<code>ObsSrvIdx</code> and <code>ObsSrvIdx_SE</code>), which are
dimensioned by by <code>n_regions</code>, <code>n_years</code>,
<code>n_srv_fleets</code>. In this case, we are modelling three survey
fleets, where fleet 1 is the bottom trawl survey, fleet 2 is the
acoustic trawl survey, and fleet 3 is the acoustic vessel of opportunity
survey. We will also input both survey age composition data and length
composition data. Both <code>ObsSrvAgeComps</code> and
<code>ObsSrvLenComps</code> are dimensioned by <code>n_regions</code>,
<code>n_years</code>, <code>n_bins (n_ages | n_lens)</code>,
<code>n_sexes</code>, <code>n_srv_fleets</code>. All three survey
indices are biomass-based and multinomial likelihoods are used to fit to
age-compositions for fleets 1 and 2. However, because the acoustic
vessel of oppurtunity survey does not have composition data, these are
not fit to (and hence specified at none).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># Setup survey indices and compositions</span></span>
<span>  <span class="va">input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Setup_Mod_SrvIdx_and_Comps.html">Setup_Mod_SrvIdx_and_Comps</a></span><span class="op">(</span></span>
<span>    input_list <span class="op">=</span> <span class="va">input_list</span>,</span>
<span></span>
<span>    <span class="co"># data inputs</span></span>
<span>    ObsSrvIdx <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">ObsSrvIdx</span>,</span>
<span>    ObsSrvIdx_SE <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">ObsSrvIdx_SE</span>,</span>
<span>    UseSrvIdx <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">UseSrvIdx</span>,</span>
<span>    ObsSrvAgeComps <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">ObsSrvAgeComps</span>,</span>
<span>    ISS_SrvAgeComps <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">ISS_SrvAgeComps</span>,</span>
<span>    UseSrvAgeComps <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">UseSrvAgeComps</span>,</span>
<span>    ObsSrvLenComps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">NA_real_</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">lens</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    UseSrvLenComps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    ISS_SrvLenComps <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span></span>
<span>    <span class="co"># Model options</span></span>
<span>    srv_idx_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"biom"</span>, <span class="st">"biom"</span>, <span class="st">"biom"</span><span class="op">)</span>,</span>
<span>    <span class="co"># abundance and biomass for survey fleet 1, 2, and 3</span></span>
<span>    SrvAgeComps_LikeType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Multinomial"</span>, <span class="st">"Multinomial"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>    <span class="co"># survey age composition likelihood for survey fleet 1, 2, and 3</span></span>
<span>    SrvLenComps_LikeType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"none"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>    <span class="co">#  survey length composition likelihood for survey fleet 1, 2, and 3</span></span>
<span>    SrvAgeComps_Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"agg_Year_1-terminal_Fleet_1"</span>,</span>
<span>      <span class="st">"agg_Year_1-terminal_Fleet_2"</span>,</span>
<span>      <span class="st">"none_Year_1-terminal_Fleet_3"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># survey age comp type</span></span>
<span></span>
<span>    SrvLenComps_Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"none_Year_1-terminal_Fleet_1"</span>,</span>
<span>      <span class="st">"none_Year_1-terminal_Fleet_2"</span>,</span>
<span>      <span class="st">"none_Year_1-terminal_Fleet_3"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># survey length comp type</span></span>
<span></span>
<span>    SrvAge_comp_agg_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="co"># ADMB aggregation quirks, ideally get rid of this</span></span>
<span>    SrvLen_comp_agg_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="co"># ADMB aggregation quirks, ideally get rid of this</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setting-up-fishery-selectivity-and-catchability">Setting up Fishery Selectivity and Catchability<a class="anchor" aria-label="anchor" href="#setting-up-fishery-selectivity-and-catchability"></a>
</h2>
<p>Fishery selectivity is specified to vary semi-parametrically for the
pollock model, with the <code>2dar1</code> option specified. Here, we
will estiamte selectivity deviations in a penalized framework and fix
variance values a priori <code>fishsel_pe_pars_spec = "fix"</code>.
Moreover, we will estiamte fishery selectivity deviations for all
dimensions, and specify correlations to be set at 0
(<code>corr_opt_semipar = "corr_zero_y_a_c"</code>). Thus,
semi-parametric deviations collapse to a simple iid formulation.
Additionally, we specify that the underlying selectivity form for the
fishery is a logistic function. Lastly, a single catchability term is
estimated to fit to the early fishery index utilized in the model
(<code>fish_q_spec = c("est_all")</code>). In the <code>Fit Model</code>
section, we will demonstrate how variance parameters can be fixed to
allow for estimation in a penalized likelihood framework.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># Setup fishery selectivity and catchability</span></span>
<span>  <span class="va">input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Setup_Mod_Fishsel_and_Q.html">Setup_Mod_Fishsel_and_Q</a></span><span class="op">(</span></span>
<span></span>
<span>    input_list <span class="op">=</span> <span class="va">input_list</span>,</span>
<span></span>
<span>    <span class="co"># Model options</span></span>
<span>    <span class="co"># fishery selectivity, whether continuous time-varying</span></span>
<span>    cont_tv_fish_sel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2dar1_Fleet_1"</span><span class="op">)</span>,</span>
<span>    fishsel_pe_pars_spec <span class="op">=</span> <span class="st">"fix"</span>, <span class="co"># doing penalized likelihood for selex devs</span></span>
<span>    fish_sel_devs_spec <span class="op">=</span> <span class="st">"est_all"</span>, <span class="co"># estimating all sel devs</span></span>
<span>    corr_opt_semipar <span class="op">=</span> <span class="st">"corr_zero_y_a_c"</span>, <span class="co"># making sure 2d correaltions are 0, collapses to a simple iid case</span></span>
<span>    <span class="co"># fishery selectivity blocks</span></span>
<span>    fish_sel_blocks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none_Fleet_1"</span><span class="op">)</span>,</span>
<span>    <span class="co"># fishery selectivity form</span></span>
<span>    fish_sel_model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logist1_Fleet_1"</span><span class="op">)</span>,</span>
<span>    <span class="co"># fishery catchability blocks</span></span>
<span>    fish_q_blocks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none_Fleet_1"</span><span class="op">)</span>,</span>
<span>    <span class="co"># whether to estiamte all fixed effects for fishery selectivity</span></span>
<span>    fish_fixed_sel_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"est_all"</span><span class="op">)</span>,</span>
<span>    <span class="co"># whether to estiamte all fixed effects for fishery catchability</span></span>
<span>    fish_q_spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"est_all"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setting-up-survey-selectivity-and-catchability">Setting up Survey Selectivity and Catchability<a class="anchor" aria-label="anchor" href="#setting-up-survey-selectivity-and-catchability"></a>
</h2>
<p>Survey selectivity is setup in a similar way. Here, we specify that
the first survey fleet has <code>iid</code> parametric deviations on a
selectivity form, while the second survey fleet has <code>2dar1</code>
semi-parametric deviations. Selectivity for survey fleet 3 is not
estimated as no age composition data are available. Therefore,
selectivity from survey fleet 2 and 3 are shared. Again, we specify that
selectivity deviations are estimated in a penalized likelihood framework
with the argument
<code>srvsel_pe_pars_spec = c("fix", "fix", "fix")</code> and specify to
set <code>2dar1</code> correlations at 0, such that semi-parametric
deviations collapse to an iid formulation
(<code>corr_opt_semipar = c(NA, "corr_zero_y_a_c", "corr_zero_y_a_c")</code>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># Setup survey selectivity and catchability</span></span>
<span>  <span class="va">input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Setup_Mod_Srvsel_and_Q.html">Setup_Mod_Srvsel_and_Q</a></span><span class="op">(</span></span>
<span>    input_list <span class="op">=</span> <span class="va">input_list</span>,</span>
<span></span>
<span>    <span class="co"># Model options</span></span>
<span>    <span class="co"># survey selectivity, whether continuous time-varying</span></span>
<span>    cont_tv_srv_sel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iid_Fleet_1"</span>, <span class="st">"2dar1_Fleet_2"</span>, <span class="st">"2dar1_Fleet_3"</span><span class="op">)</span>,</span>
<span>    srvsel_pe_pars_spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fix"</span>, <span class="st">"fix"</span>, <span class="st">"fix"</span><span class="op">)</span>, <span class="co"># penalize survey selex devs</span></span>
<span>    srv_sel_devs_spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"est_all"</span>, <span class="st">"est_all"</span>, <span class="st">"none"</span><span class="op">)</span>, <span class="co"># estimating all srv selex devs</span></span>
<span>    corr_opt_semipar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"corr_zero_y_a_c"</span>, <span class="st">"corr_zero_y_a_c"</span><span class="op">)</span>, <span class="co"># setting corelations at 0, so 2dar1 collapses to simple iid semi-parametric devs</span></span>
<span></span>
<span>    <span class="co"># survey selectivity blocks</span></span>
<span>    srv_sel_blocks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none_Fleet_1"</span>, <span class="st">"none_Fleet_2"</span>, <span class="st">"none_Fleet_3"</span><span class="op">)</span>,</span>
<span>    <span class="co"># survey selectivity form</span></span>
<span>    srv_sel_model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"logist1_Fleet_1"</span>,</span>
<span>      <span class="st">"logist1_Fleet_2"</span>,</span>
<span>      <span class="st">"logist1_Fleet_3"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># survey catchability blocks</span></span>
<span>    srv_q_blocks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none_Fleet_1"</span>, <span class="st">"none_Fleet_2"</span>, <span class="st">"none_Fleet_3"</span><span class="op">)</span>,</span>
<span>    <span class="co"># whether to estiamte all fixed effects for survey selectivity</span></span>
<span>    srv_fixed_sel_pars_spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"est_all"</span>, <span class="st">"est_all"</span>, <span class="st">"est_all"</span><span class="op">)</span>,</span>
<span>    <span class="co"># whether to estiamte all fixed effects for survey catchability</span></span>
<span>    srv_q_spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"est_all"</span>, <span class="st">"est_all"</span>, <span class="st">"est_all"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># note that AVO (fleet 3) does not have any comp data, and needs to share selectivity with ATS (fleet 2)</span></span>
<span>  <span class="va">input_list</span><span class="op">$</span><span class="va">map</span><span class="op">$</span><span class="va">ln_srv_fixed_sel_pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># share ATS and AVO selex devs</span></span>
<span>  <span class="va">map_srvsel_devs</span><span class="op">[</span>,,,,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">map_srvsel_devs</span><span class="op">[</span>,,,,<span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">input_list</span><span class="op">$</span><span class="va">map</span><span class="op">$</span><span class="va">ln_srvsel_devs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">map_srvsel_devs</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setup-model-weighting">Setup Model Weighting<a class="anchor" aria-label="anchor" href="#setup-model-weighting"></a>
</h2>
<p>We will then set up how data should be weighted with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
in this model. Here, all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
values are set at 1 and TMB likelihoods are utilized. Thus, all data
sources are weighted either using specified input sample sizes (for
composition data) or specified variances (catch and abundance
indices).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Setup_Mod_Weighting.html">Setup_Mod_Weighting</a></span><span class="op">(</span></span>
<span>  input_list <span class="op">=</span> <span class="va">input_list</span>,</span>
<span>  sablefish_ADMB <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  likelihoods <span class="op">=</span> <span class="fl">1</span>, <span class="co"># using TMB likelihoods</span></span>
<span>  Wt_Catch <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Wt_FishIdx <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Wt_SrvIdx <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Wt_Rec <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Wt_F <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Wt_Tagging <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  Wt_FishAgeComps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_regions</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>,</span>
<span>                                     <span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_sexes</span>,</span>
<span>                                     <span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_srv_fleets</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Wt_FishLenComps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_regions</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>,</span>
<span>                                     <span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_sexes</span>,</span>
<span>                                     <span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_srv_fleets</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Wt_SrvAgeComps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_regions</span>,</span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>,</span>
<span>                                    <span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_sexes</span>,</span>
<span>                                    <span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_srv_fleets</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Wt_SrvLenComps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_regions</span>,</span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>,</span>
<span>                                    <span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_sexes</span>,</span>
<span>                                    <span class="va">input_list</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_srv_fleets</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fit-model-and-plot">Fit Model and Plot<a class="anchor" aria-label="anchor" href="#fit-model-and-plot"></a>
</h2>
<p>Next, we can extract out elements created from the
<code>input_list</code> object. We will then specify the values to fix
selectivity variances at. In the first case, the fishery selectivity
variance is fixed at a value of 0.075 In the second case, the bottom
trawl survey <code>a50</code> and <code>k</code> selectivity variances
for a logistic function are fixed at 0.075 Lastly, the acoustic trawl
and vessel of opportunity surveys will have a specified variance of
0.15. For further details on the dimensionality of
<code>fishsel_pe_pars</code> and <code>srvsel_pe_pars</code>, please
refer to the <code>Description of Model Parameters</code> page.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract out lists updated with helper functions</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">input_list</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="va">input_list</span><span class="op">$</span><span class="va">par</span></span>
<span><span class="va">mapping</span> <span class="op">&lt;-</span> <span class="va">input_list</span><span class="op">$</span><span class="va">map</span></span>
<span></span>
<span><span class="co"># selex sigma to fix at, given penalized likelihood</span></span>
<span><span class="va">parameters</span><span class="op">$</span><span class="va">fishsel_pe_pars</span><span class="op">[</span>,<span class="fl">4</span>,,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.075</span><span class="op">)</span> <span class="co"># fishery selex variance</span></span>
<span><span class="va">parameters</span><span class="op">$</span><span class="va">srvsel_pe_pars</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.075</span><span class="op">)</span> <span class="co"># survey BTS - a50 and delta variance</span></span>
<span><span class="va">parameters</span><span class="op">$</span><span class="va">srvsel_pe_pars</span><span class="op">[</span>,<span class="fl">4</span>,,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.15</span><span class="op">)</span> <span class="co"># survey ATS and ato variance</span></span>
<span></span>
<span><span class="co"># Fit model</span></span>
<span><span class="va">ebswp_rtmb_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                              <span class="va">parameters</span>,</span>
<span>                              <span class="va">mapping</span>,</span>
<span>                              random <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                              newton_loops <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                              silent <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                              <span class="op">)</span></span>
<span></span>
<span><span class="co"># Get standard error report</span></span>
<span><span class="va">ebswp_rtmb_model</span><span class="op">$</span><span class="va">sd_rep</span> <span class="op">&lt;-</span> <span class="fu">RTMB</span><span class="fu">::</span><span class="fu">sdreport</span><span class="op">(</span><span class="va">ebswp_rtmb_model</span><span class="op">)</span></span></code></pre></div>
<p>Next, we can extract out parameter estimates of recruitment and
spawning biomass and compare to the 2024 pollock model.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get recruitment</span></span>
<span><span class="va">rec_series</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="op">(</span><span class="va">ebswp_rtmb_model</span><span class="op">$</span><span class="va">rep</span><span class="op">$</span><span class="va">Rec</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>se <span class="op">=</span> <span class="va">ebswp_rtmb_model</span><span class="op">$</span><span class="va">sdrep</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ebswp_rtmb_model</span><span class="op">$</span><span class="va">sdrep</span><span class="op">$</span><span class="va">value</span><span class="op">)</span> <span class="op">==</span> <span class="st">'Rec'</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">rec_series</span><span class="op">$</span><span class="va">Par</span> <span class="op">&lt;-</span> <span class="st">"Recruitment"</span></span>
<span></span>
<span><span class="co"># Get SSB time-series</span></span>
<span><span class="va">ssb_series</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="op">(</span><span class="va">ebswp_rtmb_model</span><span class="op">$</span><span class="va">rep</span><span class="op">$</span><span class="va">SSB</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>se <span class="op">=</span> <span class="va">ebswp_rtmb_model</span><span class="op">$</span><span class="va">sdrep</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ebswp_rtmb_model</span><span class="op">$</span><span class="va">sdrep</span><span class="op">$</span><span class="va">value</span><span class="op">)</span> <span class="op">==</span> <span class="st">'SSB'</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ssb_series</span><span class="op">$</span><span class="va">Par</span> <span class="op">&lt;-</span> <span class="st">"Spawning Biomass"</span></span>
<span></span>
<span><span class="co"># bind together</span></span>
<span><span class="va">ts_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ssb_series</span>,<span class="va">rec_series</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Region <span class="op">=</span> <span class="va">Var1</span>, Year <span class="op">=</span> <span class="va">Var2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Year <span class="op">=</span> <span class="va">Year</span> <span class="op">+</span> <span class="fl">1963</span>, type <span class="op">=</span> <span class="st">'SPoRC'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get actual assessment results</span></span>
<span><span class="va">ssb_ass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Region <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Year <span class="op">=</span> <span class="fl">1964</span><span class="op">:</span><span class="fl">2024</span>,</span>
<span>  value <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">SSB</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>  se <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">SSB</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,</span>
<span>  Par <span class="op">=</span> <span class="st">'Spawning Biomass'</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'2024 Pollock Assessment'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># recruitment</span></span>
<span><span class="va">rec_ass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Region <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Year <span class="op">=</span> <span class="fl">1964</span><span class="op">:</span><span class="fl">2024</span>,</span>
<span>  value <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">R</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>  se <span class="op">=</span> <span class="va">sgl_rg_ebswp_data</span><span class="op">$</span><span class="va">R</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,</span>
<span>  Par <span class="op">=</span> <span class="st">'Recruitment'</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'2024 Pollock Assessment'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># bind</span></span>
<span><span class="va">ts_df</span> <span class="op">&lt;-</span> <span class="va">ts_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">ssb_ass</span>, <span class="va">rec_ass</span><span class="op">)</span></span></code></pre></div>
<p>In general, we see that the trends in recruitment and spawning stock
biomass align relatively well. However, there are some slight
discrepancies between these estimates, likely due to the factors
discussed at the start of this vignette.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ts_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">value</span>, ymin <span class="op">=</span> <span class="va">value</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span><span class="op">)</span>,</span>
<span>                  ymax <span class="op">=</span> <span class="va">value</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">type</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Par</span>, scales <span class="op">=</span> <span class="st">'free'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="http://jrnold.github.io/ggthemes/reference/colorblind.html" class="external-link">scale_color_colorblind</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="http://jrnold.github.io/ggthemes/reference/colorblind.html" class="external-link">scale_fill_colorblind</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Year'</span>, y <span class="op">=</span> <span class="st">'Value'</span>, color <span class="op">=</span> <span class="st">'Type'</span>, fill <span class="op">=</span> <span class="st">'Type'</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/f_ebs_pol_ts_comparison.png"></p>
<p>Lastly, we can also inspect estimates of fishery selectivity from
<code>SPoRC</code>. Here, we show relative selectivity estimates for
ages 3 - 11 (panels). Note that selectivity in this model can exceed 1,
and we normalize these values in the figure to improve
interpretability</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">ebswp_rtmb_model</span><span class="op">$</span><span class="va">rep</span><span class="op">$</span><span class="va">fish_sel</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">value</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Region <span class="op">=</span> <span class="va">Var1</span>, Year <span class="op">=</span> <span class="va">Var2</span>, Age <span class="op">=</span> <span class="va">Var3</span>, Sex <span class="op">=</span> <span class="va">Var4</span>, Fleet <span class="op">=</span> <span class="va">Var5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Age</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">3</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span> <span class="op">+</span> <span class="fl">1963</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Age</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Year'</span>, y <span class="op">=</span> <span class="st">'Relative Selectivity'</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/f_ebs_pol_fishsel_comparison.png"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Cheng.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
